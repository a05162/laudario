<!DOCTYPE html>
<html lang="pt-BR">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <title>Laud√°rio Radiologia</title>
  <style>
    :root {
      /* Paleta moderna em verde-petr√≥leo */
      --bg: #0e1f1e;
      --panel: #12302e;
      --muted: #a7c2bf;
      --text: #ffffff;
      
      --accent: #3fd1b8;
      --accent-2: #29b7a0;
      --border: #1d3e3c;

      /* Cards */
      --cat-bg: #153b38;
      --cat-head: #1b4a46;

      /* Frases */
      --phrase-bg: #f5f7f6;
      --phrase-border: #cfd6d4;
      --phrase-text: #0d1817;
    }

    html, body {
      height: 100%; 
      background: var(--bg); 
      color: var(--text); 
    }

    body {
      margin: 0; 
      font-family: system-ui, -apple-system, Segoe UI, Roboto, Ubuntu, Cantarell, Noto Sans;
    }

    html.sizeA { font-size: 15px; }
    html.sizeB { font-size: 17px; }
    html.sizeC { font-size: 19px; }

    .app { display: grid; grid-template-rows: auto auto 1fr; min-height: 100vh; }

    header {
      position: sticky; top: 0; z-index: 10;
      display: grid; grid-template-columns: 1fr auto 1fr; align-items: center;
      gap: .75rem; padding: .75rem 1rem;
      background: var(--panel);
      border-bottom: 1px solid var(--border);
    }

    .brand { display: flex; align-items: center; gap: .5rem; }

    .brand .dot {
      width: .6rem; height: .6rem; border-radius: 9999px;
      background: var(--accent);
      box-shadow: 0 0 0 .2rem rgba(63,209,184,.25);
    }

    .org-select select {
      background: #0f2725; color: var(--text);
      border: 1px solid var(--border);
      border-radius: .4rem;
      padding: .45rem .6rem;
      cursor: pointer;
    }

    .search { justify-self: center; width: min(680px, 95%); }

    .search input {
      width: 100%;
      background: #0c2422;
      color: var(--text);
      border: 1px solid var(--border);
      padding: .55rem .8rem;
      border-radius: .4rem;
    }

    main { padding: 1rem; }
    .header-right { height: 1rem; }

    .cat-grid {
      display:grid;
      grid-template-columns: repeat(auto-fill, minmax(280px, 1fr));
      gap: 1rem;
    }

    .cat-card {
      background: var(--cat-bg);
      border:1px solid var(--border);
      border-radius:.6rem;
      display:flex; flex-direction:column;
    }

    .cat-head {
      display:flex; justify-content:space-between; align-items:center;
      padding:.75rem .9rem;
      background: var(--cat-head);
      border-bottom:1px solid var(--border);
    }

    .btn-icon {
      display:inline-grid; place-items:center;
      width:32px; height:32px;
      background:rgba(255,255,255,.07);
      border:1px solid var(--border);
      border-radius:.4rem;
      cursor:pointer;
      color:white;
    }

    .phrases { padding:.8rem; display:flex; flex-direction:column; gap:.5rem; }

    .phrase {
      background: var(--phrase-bg);
      border:1px solid var(--phrase-border);
      border-radius:.5rem;
      padding:.6rem .7rem;
      color: var(--phrase-text);
      cursor:pointer;
      position:relative;
    }

    .phrase:hover { background:white; border-color:var(--accent); }

    .copy-hint {
      position:absolute; right:.6rem; bottom:.45rem;
      font-size:.74rem; color:#555;
    }

    .fab {
      position:fixed; right:1rem; bottom:1rem;
      width:48px; height:48px;
      background:var(--accent);
      border-radius:.6rem;
      cursor:pointer;
      border:none;
      color:#01201c;
      font-weight:bold;
    }

    /* === TELA DE SENHA === */
    #lockScreen {
      position: fixed;
      inset: 0;
      background: #0e1f1e;
      display: flex;
      flex-direction: column;
      justify-content: center;
      align-items: center;
      gap: 1.2rem;
      z-index: 9999;
      color: white;
      font-family: system-ui;
    }

    #lockBox {
      display:flex; flex-direction:column; align-items:center; gap:.7rem;
    }

    #passwordInput {
      width:220px; padding:.7rem 1rem;
      background:#12302e; border:1px solid #1d3e3c;
      border-radius:.5rem; color:white; font-size:1rem;
    }

    #togglePass {
      position:absolute; right:10px; top:50%;
      transform:translateY(-50%);
      cursor:pointer;
      user-select:none;
    }

    #enterBtn {
      width:220px; padding:.7rem 1rem;
      background:#29b7a0; border:none;
      border-radius:.5rem;
      color:black; font-weight:600;
      cursor:pointer;
    }
  </style>
</head>
<body>

<!-- üîí TELA DE SENHA -->
<div id="lockScreen">
  <h2 style="margin:0; font-size:1.6rem;">Acesso Restrito</h2>

  <div id="lockBox">
    <div style="position:relative; width:220px;">
      <input id="passwordInput" type="password" placeholder="Digite a senha">
      <span id="togglePass">üëÅÔ∏è</span>
    </div>

    <button id="enterBtn" onclick="unlockSite()">Entrar</button>
    <small id="wrongPass" style="display:none; color:#ff7f7f;">Senha incorreta</small>
  </div>
</div>

  <div class="app">
    <header>
      <div class="brand org-select">
        <span class="dot"></span>
        <select id="organSelect"></select>
      </div>
      <div class="search">
        <input id="searchInput" type="search" placeholder="Buscar frase‚Ä¶ (Enter para aplicar)" />
      </div>
      <div class="header-right"></div>
    </header>

    <main><div class="cat-grid" id="catGrid"></div></main>

    <footer><small>Click para copiar ‚Ä¢ Tamanho: A/B/C</small></footer>
  </div>

  <button id="sizeFab" class="fab">+Aa</button>

<script>
/* ================================
   L√ìGICA ORIGINAL (inalterada)
================================ */
const DB = new Map();
const ORG_ORDER = [];
const DEFAULT_CATEGORY = "Geral";
let currentOrgan = null;
let currentQuery = "";

const qs = (sel, el=document) => el.querySelector(sel);
const normalize = s => s.normalize("NFD").replace(/\p{Diacritic}+/gu, "").toLowerCase();

function parseLaudario(txt) {
  DB.clear(); ORG_ORDER.length = 0;
  let organ = null, category = null;

  for (const raw of txt.split(/\r?\n/)) {
    const line = raw.trim();
    if (!line || line.startsWith("#") || line.startsWith(";")) continue;

    const sect = line.match(/^\[(.+?)\]$/);
    if (sect) {
      const parts = sect[1].split(">").map(s => s.trim());
      organ = parts[0];
      category = parts[1] || DEFAULT_CATEGORY;

      if (!DB.has(organ)) { DB.set(organ, new Map()); ORG_ORDER.push(organ); }
      if (!DB.get(organ).has(category)) DB.get(organ).set(category, []);
      continue;
    }

    if (organ) DB.get(organ).get(category).push(line);
  }
}

function renderOrganSelect() {
  const sel = qs("#organSelect");
  sel.innerHTML = "";
  for (const organ of ORG_ORDER) {
    sel.innerHTML += `<option value="${organ}">${organ}</option>`;
  }
  if (currentOrgan) sel.value = currentOrgan;
}

function renderCategoryCards() {
  const grid = qs("#catGrid");
  grid.innerHTML = "";

  const catMap = DB.get(currentOrgan);
  if (!catMap) return;

  const cats = Array.from(catMap.entries()).sort((a,b)=>a[0].localeCompare(b[0]));

  for (const [cat, list] of cats) {
    const items = currentQuery ? list.filter(x => normalize(x).includes(normalize(currentQuery))) : list;

    if (!items.length) continue;

    const card = document.createElement("section");
    card.className = "cat-card";

    const head = document.createElement("div");
    head.className = "cat-head";

    const title = document.createElement("div");
    title.className = "cat-title";
    title.textContent = cat;

    const actions = document.createElement("div");
    actions.className = "cat-actions";

    const copyBtn = document.createElement("button");
    copyBtn.className = "btn-icon";
    copyBtn.textContent = "üìã";
    copyBtn.onclick = () => {
      navigator.clipboard.writeText(items.join("\n\n"));
      copyBtn.textContent = "‚úì";
      setTimeout(()=>copyBtn.textContent="üìã",900);
    };

    actions.appendChild(copyBtn);
    head.appendChild(title);
    head.appendChild(actions);

    const ul = document.createElement("div");
    ul.className = "phrases";

    for (const text of items) {
      const li = document.createElement("div");
      li.className = "phrase";
      li.textContent = text;

      const hint = document.createElement("small");
      hint.className = "copy-hint";
      hint.textContent = "Copiar";
      li.appendChild(hint);

      li.onclick = () => {
        navigator.clipboard.writeText(text);
        hint.textContent = "Copiado!";
        setTimeout(()=>hint.textContent="Copiar",900);
      };

      ul.appendChild(li);
    }

    card.appendChild(head);
    card.appendChild(ul);
    grid.appendChild(card);
  }
}

function parseHash() {
  const h = location.hash.slice(1);
  const [path, queryStr] = h.split("?");
  const parts = (path || "").split("/").filter(Boolean);
  let org = parts[1] ? decodeURIComponent(parts[1]) : null;
  const query = new URLSearchParams(queryStr || "").get("q") || "";
  return { org, query };
}

function navigate(org, query=currentQuery) {
  if (!org) org = ORG_ORDER[0];
  const enc = encodeURIComponent(org);
  const params = new URLSearchParams();
  if (query) params.set("q", query);
  location.hash = `#/orgao/${enc}${params.toString()?`?${params}`:""}`;
}

function applyRoute() {
  const r = parseHash();
  currentOrgan = r.org && DB.has(r.org) ? r.org : ORG_ORDER[0];
  currentQuery = r.query || "";
  renderOrganSelect();
  qs("#searchInput").value = currentQuery;
  renderCategoryCards();
}

window.addEventListener("hashchange", applyRoute);
qs("#organSelect").addEventListener("change", e => navigate(e.target.value, ""));
qs("#searchInput").addEventListener("keydown", e => {
  if (e.key === "Enter") navigate(currentOrgan, e.target.value.trim());
});

qs("#sizeFab").addEventListener("click", () => {
  const sizes = ["sizeA","sizeB","sizeC"];
  const html = document.documentElement;
  const idx = sizes.findIndex(s => html.classList.contains(s));
  html.classList.remove(...sizes);
  html.classList.add(sizes[(idx+1)%sizes.length]);
  localStorage.setItem("ui.size", html.className);
});

(async function init(){
  const cls = localStorage.getItem("ui.size");
  if (cls) document.documentElement.className = cls;
  else document.documentElement.classList.add("sizeB");

  const txt = await (await fetch("laudario.txt")).text();
  parseLaudario(txt);

  currentOrgan = ORG_ORDER[0];
  renderOrganSelect();
  applyRoute();
})();

/* ===============================
      üîí SISTEMA DE SENHA
=============================== */

const PASSWORD = "radiologia123";  // << TROQUE A SENHA AQUI

function unlockSite() {
  const input = document.getElementById("passwordInput").value;
  if (input === PASSWORD) {
    document.getElementById("lockScreen").style.display = "none";
  } else {
    document.getElementById("wrongPass").style.display = "block";
  }
}

document.getElementById("togglePass").onclick = () => {
  const field = document.getElementById("passwordInput");
  field.type = field.type === "password" ? "text" : "password";
  document.getElementById("togglePass").textContent =
    field.type === "password" ? "üëÅÔ∏è" : "üôà";
};
</script>

</body>
</html>
